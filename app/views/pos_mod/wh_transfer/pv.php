<?php
session_start();
//====================== EOF ===================
//var_dump($_SESSION);
require "../../support/inc.all.php";
require "../../../engine/tools/class.numbertoword.php";


$sql="SELECT * FROM `production_issue_master` WHERE  pi_no not in (22710,22403,22408,22411,22438,22439,22448,22449,22466,22491,22492,22494,22502,22525,22557,22563,22564,22575,22576,22579,22583,22588,22590,22592,22595,22598,22615,22634,22635,22637,22642,22644,22645,22646,22656,22709,22669,22707,22677,22680,22682,22683,22685,22687,22689,22695,22697,22698,22702,22724,22735,22736,22737,22763,22764,22772,22773,22776,22782,22783,22785,22786,22789,22790,22791,22794,22795,22796,22797,22800,22811,22821,22917,22828,22831,22833,22836,22838,22842,22843,22857,22858,22860,22863,22866,22889,22895,22901,22905,22907,22909,22910,22911,22936,22938,22939,22940,22941,22944,22946,22948,22959,22961,22963,22964,22965,22966,22980,23019,23024,23025,23037,23049,23050,23051,23053,23056,23057,23062,23065,23070,23097,23103,23109,23134,23156,23158,23174,23183,23187,23189,23191,23192,23193,23234,23255,23271,23272,23274,23276,23302,23304,23322,23325,23338,23345,23352,23369,23371,23375,23376,23377,23379,23381,23383,23400,23410,23412,23428,23446,23534,23542,23564,23579,23588,23593,23599,23614,23627,23633,23640,23643,23645,23651,23657,23676,23678,23710,23718,23721,23722,23724,23725,23726,23729,23799,23811,23815,23822,23838,23844,23847,23849,23857,23874,23879,23880,23881,23882,23883,23888,23908,23933,23948,23965,23970,23972,23973,23977,23979,24023,24026,24031,24046,24072,24073,24076,24093,24105,24106,24107,24112,24135,24149,24151,24153,24156,24166,24161,24174,24175,24184,24190,24201,25019,24210,24211,24230,24235,24239,24347,24254,24255,24285,24286,24287,24296,24298,24299,24301,24327,24342,24345,24348,24366,24368,24369,24377,24395,24396,24408,24412,24433,24435,24436,24453,24466,24467,24480,24488,24491,24494,24495,24496,24498,24527,24528,24529,24532,24535,24545,24570,24581,24582,24587,24589,24590,24614,24616,24625,24649,24651,24652,24659,24671,24672,24674,24683,24700,24715,24720,24721,24725,24729,24742,24752,24767,24779,24783,24793,24801,24802,24804,24806,24813,24814,24828,24846,24852,24856,24859,24863,24876,24888,24892,24897,24904,24908,24911,24912,24944,24945,24954,24956,24957,24961,24971,24972,24973,24977,24978,24981,24982,24987,24997,24998,24999,25000,25001,25003,25004,25005,25020,25021,25026,25027,25029,25031,25037,25038,25053,25054,25057,25058,25059,25065,25075,25081,25082,25085,25087,25088,25110,25118,25119,25122,25130,25145,25147,25148,25149,25151,25161,25162,25168,25172,25173,25176,25194,25197,25198,25199,25208,25209,25211,25225,25254,25255,25256,25257,25258,25259,25267,25268,25292,25293,25294,25296,25298,25299,25302,25314,25317,25318,25319,25333,25334,25335,25336,25337,25346,25349,25362,25368,25375,25376,25377,25400,25403,25431,25434,25451,25452,25457,25473,25474,25475,25476,25479,25491,25492,25494,25495,25506,25507,25523,25527,25528,25543,25547,25548,25574,25581,25586,25589,25594,25630,25632,25633,25659,25663,25667,25715,25717,25719,25721,25746,25749,25752,25753,25778,25781,25783,25814,25838,25862,25863,25870,25908,25910,25911,25912,25929,25937,25940,25977,26003,26004,26014,26016,26051,26057,26058,26059,26060,26080,26081,26083,26085,26086,26091,26092,26094,26101,26104,26114,26128,26130,26131,26137,26139,26140,26151,26153,26154,26155,26156,26160,26161,26162,26181,26183,26191,26192,26195,26214,26220,26235,26237,26238,26239,26240,26241,26242,26254,26255,26256,26258,26268,26269,26270,26272,27660,26290,26300,26306,26320,26321,26324,26327,26328,26373,26374,26378,26380,26382,26383,26392,26396,26397,26403,26405,26407,26408,26409,26425,26431,26439,26440,26450,26452,26453,26457,26478,26479,26480,26482,26483,26484,26499,26524,26539,26540,26542,26543,26544,26546,26547,26548,26549,26551,26561,26564,26570,26571,26572,26573,26575,26580,26581,26599,26604,26605,26606,26609,26612,26613,26632,26643,26644,26645,26646,26649,26650,26651,26653,26673,26689,26693,26697,26699,26701,26725,26727,26746,26752,26765,26766,26767,26770,26780,26782,26799,26802,26805,26811,26816,26817,26818,26819,26839,26847,26850,26851,26876,26878,26896,26918,27068,26935,26937,26980,27019,27020,27022,27025,27056,27062,27066,27072,27075,27103,27120,27122,27129,27143,27144,27147,27148,27155,27156,27161,27162,27179,27182,27186,27187,27188,27189,27195,27202,27207,27254,27256,27257,27272,27273,27289,27292,27299,27307,27311,27312,27313,27314,27316,27319,27349,27358,27375,27377,27382,27385,27387,27398,27400,27408,27411,27412,27413,27427,27439,27440,27441,27456,27461,27464,27467,27473,27478,27480,27481,27483,27492,27493,27494,27495,27518,27526,27533,27536,27539,27540,27542,27544,27561,27562,27569,27574,27593,27595,27597,27626,27635,27636,27652,27668,27677,27696,27701,27710,27711,27713,27714,27726,27733,27737,27738,27741,27742,27747,27750,27751,27758,27761,27775,27776,27787,27796,27814,27818,27820,27821,27825,27827,27831,27846,27848,27849,27850,27877,27886,27889,27992,27920,27921,27926,27935,27946,27948,27976,27977,27983,27989,27996,28014,28020,28021,28061,28064,28074,28076,28079,28118,28120,28126,28134,28137,28138,28141,28143,28162,28172,28174,28175,28185,28199,28201,28202,28208,28209,28211,28213,28228,28230,28231,28232,28273,28275,28276,28294,28296,28297,28310,28321,28323,28325,28326,28328,28335,28347,28349,28354,28355,28356,28362,28363,28364,28365,28367,28368,28369,28371,28374,28375,28378,28379,28380,28381,28382,28383,28384,28389,28391,28392,28393,28404,28425,28445,28446,28451,28453,28454,28455,28457,28458,28459,28462,28475,28476,28477,28478,28493,28495,28499,28505,27715,27716,27717,27718,27719,27720,27722,27724,27725,28561,28503,28504,28510,28513,28536,28538,28556,28557,28558,28559,28560,28555,28566,28567,28577,28596,28597,28598,28601,24048,24068,24095,24109,24129,24152,24155,24160,24173,24193,24196,24202,24232,24259,24326,24341,24346,24378,24394,24397,24398,24399,24400,24401,24407,24409,24411,24415,24416,24428,24429,24430,24437,24451,24452,24454,24457,24469,24479,24493,24526,24588,24613,24626,24647,24687,24701,24702,24710,24722,24726,24734,24735,24745,24757,24758,24780,24817,25079,25084,25086,25125,25142,25144,25190,25338,25437,25477,25550,25613,25619,25621,25623,25631,25648,25654,25682,25716,25718,25720,25723,25736,25740,25751,25754,25758,25776,25792,25808,25809,25810,25812,25823,25832,25839,25864,25869,25935,25945,25979,26017,26055,26062,26063,26064,26070,26087,26102,26124,26129,26145,26194,26232,26257,26260,26266,26273,26292,26313,26325,26326,26332,26348,26352,26370,26375,26377,26395,26400,26401,26406,26438,26447,26449,26451,26481,26493,26494,26495,26530,26578,26579,26584,26614,26642,26690,26703,26726,26731,26773,26779,26781,26808,26815,26821,26831,26849,26879,26929,26981,27028,27055,27065,27071,27205,27213,27246,27275,27290,27351,27394,27407,27429,27448,27460,27465,27479,27482,27520,27531,27568,27614,27630,27680,27700,27702,27721,27723,27739,27740,27743,27746,27797,27815,27816,27817,27823,27829,27843,27879,27882,27883,27895,27915,27923,27930,27931,27949,27956,27966,27967,27990,27993,28035,28068,28077,28081,28128,28136,28142,28144,28210,28227,28256,28274,28339,28386,28479,28508,28647,28644,28642,28640,28637,28691,28695,28677,28676,28648,28645,28639,28696,28701,28703,28705,28707,28709,28718,28719
) and pi_date>'2015-06-29' and warehouse_from = 5 and warehouse_to in (3,6,9,7,10,8,11,54)";
$data=mysql_query($sql);
while($pi=mysql_fetch_object($data))
{echo ++$i.'<br>';
$pi_no = $pi->pi_no;
$sales_ledger = 1070000100020000;
$cc_code = find_a_field_sql('select c.id from cost_center c, warehouse w where c.cc_code=w.acc_code and w.warehouse_id='.$pi->warehouse_to);
$ledger = find_a_field('warehouse','ledger_id','warehouse_id='.$pi->warehouse_to);	
$narration = 'PI No-'.$pi_no.'||RSL-'.$pi->rec_sl_no.'||RecDt:'.$pi->receive_date;
auto_insert_sale_sc($pi->pi_date,$ledger,$sales_ledger,$pi_no,find_a_field('production_issue_detail','sum(total_amt)','pi_no='.$pi_no),$pi_no,$cc_code,$narration);
}
?>